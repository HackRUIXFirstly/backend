#!/usr/bin/env node
var app = require('../app');
var mongoose = require('mongoose');

mongoose.connect(process.env.MONGO_URI || 'mongodb://localhost/firstly');

app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  console.log('Express server listening on port ' + server.address().port);
});

process.on('SIGTERM', function() {
  server.close(function() {
    process.exit(0);
  })
});

process.on('exit', function(){
  console.log("Server is exiting");
  mongoose.connection.close();
  console.log("Server has closed all connections");
});
